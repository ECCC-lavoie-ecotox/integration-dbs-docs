[
  {
    "objectID": "tbl_measurements.html",
    "href": "tbl_measurements.html",
    "title": "Description des contaminants",
    "section": "",
    "text": "On cherche à obtenir une liste exhaustive des contaminants mesurés chez quatre espèces impliquées dans le PASL.\n\n\nRecencement des fichiers et des feuillets (1 feuillet = 1 famille) Pour chacun des fichiers et feuillets, j’identifie la plage de colonne dans laquelle se retrouve les valeurs des contaminants (voir la liste intitulée “sheets” pour chacun des fichiers).\n\ncontaminants_mapping &lt;- list(\n    herons = list(\n        path = \"Z:/01-Projets et suivis/PASL/GrandHeron/Base de donnees GBHE oeufs.xlsx\",\n        sheets = list(\n            PFC = c(\"PFBA\", \"PFDS\"),\n            OC = c(\"1.2.4.5-Tetrachlorobenzene\", \"TCPM\"),\n            PCB = c(\"PCB18/17\", \"Aroclor1260\"),\n            BFR = c(\"BDE-7\", \"anti-DP\"),\n            `non-ortho PCBs` = c(\"PCB-81\", \"PCB-169\"),\n            `PCDDs & PCDFs` = c(\"2378-TCDD\", \"OCDF\"),\n            Toxaphene = c(\"Total toxaphene\", \"B9-1025\"),\n            FAME = c(\"Caproic Acid\", \"Docosahexaenoic Acid (DHA)\"),\n            THg = c(\"THg-dw\", \"THg-ww\"),\n            SI = c(\"d13C\", \"d34S\")\n        )\n    ),\n    eiders = list(\n        path = \"Z:/01-Projets et suivis/PASL/EiderDuvet/Base de donnees COEI.xlsx\",\n        sheets = list(\n            PFC = c(\"PFBA\", \"PFDS\"),\n            OC = c(\"1,2,4,5-Tetrachlorobenzene\", \"Mirex\"),\n            PCB = c(\"PCB17/18\", \"PCB209\"),\n            BFR = c(\"b-TBECH/BDE15\", \"BB101\"),\n            THg = c(\"THg_dw\", \"THg_ww\")\n        )\n    ),\n    gulls = list(\n        path = \"Z:/01-Projets et suivis/PASL/GoelandArgenté/Base de donnees HERG.xlsx\",\n        sheets = list(\n            PFC = c(\"PFBA\", \"PFDS\"),\n            OC = c(\"1,2,4,5-Tetrachlorobenzene\", \"Mirex\"),\n            PCB = c(\"PCB17/18\", \"PCB209\"),\n            BFR = c(\"b-TBECH/BDE15\", \"BB101\"),\n            THg = c(\"THg\", \"THg\"),\n            SI = c(\"d13C\", \"d34S\")\n        )\n    ),\n    gannets = list(\n        path = \"Z:/01-Projets et suivis/PASL/FouBassan/Stats_NOGA_Temporal2022/Integration_ST LAWRENCE_Gannets Trends 1969-2019_OC-PCB-FR Metals D-F FAME CNS.xlsx\",\n        sheets = list(\n            OC = c(\"1245TCB\", \"Mirex\"),\n            PCB = c(\"PCB18/17\", \"Aroclor1260\"),\n            BFR = c(\"BDE-15_B-TBECH\", \"anti-DP\"),\n            `Non-ortho PCBs` = c(\"PCB 81\", \"PCB 169\"),\n            `PCDDs & PCDFs` = c(\"2378-TCDD\", \"OCDF\"),\n            Metal = c(\"THg\", \"Al\"),\n            FAME = c(\"caproic acid\", \"docosahexaenoic acid (DHA)\"),\n            SI = c(\"d15N\", \"CN\")\n        )\n    )\n)\n\n\n\n\nOn effectue une double map (comme une double loop). Cette opération va extraire les valeurs de contaminants en traversant les classeurs (1 par espèce), et les feuillets (1 par famille de contaminant).\n\ncontaminants &lt;- purrr::map(\n    # Loop over species dataset\n    contaminants_mapping, \\(f){\n        # Copy the excel file locally in the temp folder\n        tmp_file &lt;- tempfile()\n        file.copy(f$path, tmp_file, overwrite = TRUE)\n        # Loop over sheets\n        purrr::map2(f$sheets, names(f$sheets), \\(s, n){\n            readxl::read_excel(tmp_file, sheet = n) |&gt;\n                dplyr::select(\"Year\", \"Location\", \"SampleID\", \"Species\", s[1]:s[2]) |&gt;\n                dplyr::mutate(source = f$path, conpound_family = n) |&gt;\n                dplyr::mutate(across(everything(), as.character)) |&gt;\n                tidyr::pivot_longer(cols = s[1]:s[2], names_to = \"variable\") |&gt;\n                dplyr::filter(!is.na(value))\n        }) |&gt; dplyr::bind_rows()\n}) |&gt; dplyr::bind_rows()\n\ncontaminants |&gt; dplyr::group_by(Location) |&gt; dplyr::summarize(\n    nSpecies = dplyr::n_distinct(Species)) |&gt; dplyr::arrange(desc(nSpecies))\n\n# A tibble: 66 × 2\n   Location                                    nSpecies\n   &lt;chr&gt;                                          &lt;int&gt;\n 1 Ile Laval                                          3\n 2 Ile aux Oeufs                                      2\n 3 Kamouraska                                         2\n 4 Missipinuk (Grosse Romaine)                        2\n 5 Archipel de Mingan (approximative location)        1\n 6 Battures aux Loups Marins                          1\n 7 Beauharnois                                        1\n 8 Betchouanes                                        1\n 9 Bonaventure                                        1\n10 Bonaventure Island                                 1\n# ℹ 56 more rows\n\n\n\n\n\nCertains noms de composées divergent entre les différents classeurs de données (espèces)\ndups_contaminants &lt;- contaminants |&gt; \n    dplyr::group_by(conpound_family, variable) |&gt;\n    dplyr::arrange(desc(variable)) |&gt;\n    dplyr::count()\n\nreactable::reactable(dups_contaminants)\n\n\nAtelier 1: Jouer a pareil, pas pareil, pour consolider la nomenclature des contaminants\n\n\n\ndups_sites &lt;- contaminants |&gt; \n    dplyr::group_by(Location) |&gt;\n    dplyr::count()\n\nreactable::reactable(dups_sites)\n\n\nAtelier 2: Jouer a pareil, pas pareil, pour consolider la nomenclature des sites\n\n\n\nOn applique la transformation avec la fonction toxbox::uncensored().\n\ncontaminants_uncensored &lt;- contaminants |&gt; \n    toxbox::uncensored(cols = \"value\", keep_cens = TRUE)\n\nWarning: There was 1 warning in `dplyr::mutate()`.\nℹ In argument: `dplyr::across(tidyselect::all_of(cols), remove_cens)`.\nCaused by warning:\n! NAs introduced by coercion\n\n\nIsolation des valeurs NA’s pour comprendre quelles sont les mesures qui ne peuvent pas être transformé en valeur numérique.\n\n\n\ntable(is.na(contaminants_uncensored$value))\n\n\nFALSE  TRUE \n31592   780 \n\n\n\n\n\n\ncontaminants_uncensored |&gt; \n    dplyr::filter(is.na(value)) |&gt;\n    dplyr::group_by(source, conpound_family) |&gt;\n    dplyr::count() |&gt;\n    dplyr::arrange(source) |&gt;\n    reactable::reactable()\n\n\n\n\n\n\n\n\nTODO: A compléter ici, marche pas\n\ncontaminants |&gt; \n    dplyr::filter(stringr::str_detect(stringr::str_trim(value), \"[:alpha:]\")) |&gt;\n    as.data.frame() |&gt;\n    reactable::reactable()",
    "crumbs": [
      "Consolider les données",
      "Description des contaminants"
    ]
  },
  {
    "objectID": "tbl_measurements.html#otenir-une-liste-exhaustive-des-contaminants",
    "href": "tbl_measurements.html#otenir-une-liste-exhaustive-des-contaminants",
    "title": "Description des contaminants",
    "section": "",
    "text": "On cherche à obtenir une liste exhaustive des contaminants mesurés chez quatre espèces impliquées dans le PASL.\n\n\nRecencement des fichiers et des feuillets (1 feuillet = 1 famille) Pour chacun des fichiers et feuillets, j’identifie la plage de colonne dans laquelle se retrouve les valeurs des contaminants (voir la liste intitulée “sheets” pour chacun des fichiers).\n\ncontaminants_mapping &lt;- list(\n    herons = list(\n        path = \"Z:/01-Projets et suivis/PASL/GrandHeron/Base de donnees GBHE oeufs.xlsx\",\n        sheets = list(\n            PFC = c(\"PFBA\", \"PFDS\"),\n            OC = c(\"1.2.4.5-Tetrachlorobenzene\", \"TCPM\"),\n            PCB = c(\"PCB18/17\", \"Aroclor1260\"),\n            BFR = c(\"BDE-7\", \"anti-DP\"),\n            `non-ortho PCBs` = c(\"PCB-81\", \"PCB-169\"),\n            `PCDDs & PCDFs` = c(\"2378-TCDD\", \"OCDF\"),\n            Toxaphene = c(\"Total toxaphene\", \"B9-1025\"),\n            FAME = c(\"Caproic Acid\", \"Docosahexaenoic Acid (DHA)\"),\n            THg = c(\"THg-dw\", \"THg-ww\"),\n            SI = c(\"d13C\", \"d34S\")\n        )\n    ),\n    eiders = list(\n        path = \"Z:/01-Projets et suivis/PASL/EiderDuvet/Base de donnees COEI.xlsx\",\n        sheets = list(\n            PFC = c(\"PFBA\", \"PFDS\"),\n            OC = c(\"1,2,4,5-Tetrachlorobenzene\", \"Mirex\"),\n            PCB = c(\"PCB17/18\", \"PCB209\"),\n            BFR = c(\"b-TBECH/BDE15\", \"BB101\"),\n            THg = c(\"THg_dw\", \"THg_ww\")\n        )\n    ),\n    gulls = list(\n        path = \"Z:/01-Projets et suivis/PASL/GoelandArgenté/Base de donnees HERG.xlsx\",\n        sheets = list(\n            PFC = c(\"PFBA\", \"PFDS\"),\n            OC = c(\"1,2,4,5-Tetrachlorobenzene\", \"Mirex\"),\n            PCB = c(\"PCB17/18\", \"PCB209\"),\n            BFR = c(\"b-TBECH/BDE15\", \"BB101\"),\n            THg = c(\"THg\", \"THg\"),\n            SI = c(\"d13C\", \"d34S\")\n        )\n    ),\n    gannets = list(\n        path = \"Z:/01-Projets et suivis/PASL/FouBassan/Stats_NOGA_Temporal2022/Integration_ST LAWRENCE_Gannets Trends 1969-2019_OC-PCB-FR Metals D-F FAME CNS.xlsx\",\n        sheets = list(\n            OC = c(\"1245TCB\", \"Mirex\"),\n            PCB = c(\"PCB18/17\", \"Aroclor1260\"),\n            BFR = c(\"BDE-15_B-TBECH\", \"anti-DP\"),\n            `Non-ortho PCBs` = c(\"PCB 81\", \"PCB 169\"),\n            `PCDDs & PCDFs` = c(\"2378-TCDD\", \"OCDF\"),\n            Metal = c(\"THg\", \"Al\"),\n            FAME = c(\"caproic acid\", \"docosahexaenoic acid (DHA)\"),\n            SI = c(\"d15N\", \"CN\")\n        )\n    )\n)\n\n\n\n\nOn effectue une double map (comme une double loop). Cette opération va extraire les valeurs de contaminants en traversant les classeurs (1 par espèce), et les feuillets (1 par famille de contaminant).\n\ncontaminants &lt;- purrr::map(\n    # Loop over species dataset\n    contaminants_mapping, \\(f){\n        # Copy the excel file locally in the temp folder\n        tmp_file &lt;- tempfile()\n        file.copy(f$path, tmp_file, overwrite = TRUE)\n        # Loop over sheets\n        purrr::map2(f$sheets, names(f$sheets), \\(s, n){\n            readxl::read_excel(tmp_file, sheet = n) |&gt;\n                dplyr::select(\"Year\", \"Location\", \"SampleID\", \"Species\", s[1]:s[2]) |&gt;\n                dplyr::mutate(source = f$path, conpound_family = n) |&gt;\n                dplyr::mutate(across(everything(), as.character)) |&gt;\n                tidyr::pivot_longer(cols = s[1]:s[2], names_to = \"variable\") |&gt;\n                dplyr::filter(!is.na(value))\n        }) |&gt; dplyr::bind_rows()\n}) |&gt; dplyr::bind_rows()\n\ncontaminants |&gt; dplyr::group_by(Location) |&gt; dplyr::summarize(\n    nSpecies = dplyr::n_distinct(Species)) |&gt; dplyr::arrange(desc(nSpecies))\n\n# A tibble: 66 × 2\n   Location                                    nSpecies\n   &lt;chr&gt;                                          &lt;int&gt;\n 1 Ile Laval                                          3\n 2 Ile aux Oeufs                                      2\n 3 Kamouraska                                         2\n 4 Missipinuk (Grosse Romaine)                        2\n 5 Archipel de Mingan (approximative location)        1\n 6 Battures aux Loups Marins                          1\n 7 Beauharnois                                        1\n 8 Betchouanes                                        1\n 9 Bonaventure                                        1\n10 Bonaventure Island                                 1\n# ℹ 56 more rows\n\n\n\n\n\nCertains noms de composées divergent entre les différents classeurs de données (espèces)\ndups_contaminants &lt;- contaminants |&gt; \n    dplyr::group_by(conpound_family, variable) |&gt;\n    dplyr::arrange(desc(variable)) |&gt;\n    dplyr::count()\n\nreactable::reactable(dups_contaminants)\n\n\nAtelier 1: Jouer a pareil, pas pareil, pour consolider la nomenclature des contaminants\n\n\n\ndups_sites &lt;- contaminants |&gt; \n    dplyr::group_by(Location) |&gt;\n    dplyr::count()\n\nreactable::reactable(dups_sites)\n\n\nAtelier 2: Jouer a pareil, pas pareil, pour consolider la nomenclature des sites\n\n\n\nOn applique la transformation avec la fonction toxbox::uncensored().\n\ncontaminants_uncensored &lt;- contaminants |&gt; \n    toxbox::uncensored(cols = \"value\", keep_cens = TRUE)\n\nWarning: There was 1 warning in `dplyr::mutate()`.\nℹ In argument: `dplyr::across(tidyselect::all_of(cols), remove_cens)`.\nCaused by warning:\n! NAs introduced by coercion\n\n\nIsolation des valeurs NA’s pour comprendre quelles sont les mesures qui ne peuvent pas être transformé en valeur numérique.\n\n\n\ntable(is.na(contaminants_uncensored$value))\n\n\nFALSE  TRUE \n31592   780 \n\n\n\n\n\n\ncontaminants_uncensored |&gt; \n    dplyr::filter(is.na(value)) |&gt;\n    dplyr::group_by(source, conpound_family) |&gt;\n    dplyr::count() |&gt;\n    dplyr::arrange(source) |&gt;\n    reactable::reactable()\n\n\n\n\n\n\n\n\nTODO: A compléter ici, marche pas\n\ncontaminants |&gt; \n    dplyr::filter(stringr::str_detect(stringr::str_trim(value), \"[:alpha:]\")) |&gt;\n    as.data.frame() |&gt;\n    reactable::reactable()",
    "crumbs": [
      "Consolider les données",
      "Description des contaminants"
    ]
  },
  {
    "objectID": "tbl_measurements.html#objectif-2-déterminer-la-taille-déchantillons",
    "href": "tbl_measurements.html#objectif-2-déterminer-la-taille-déchantillons",
    "title": "Description des contaminants",
    "section": "Objectif 2: Déterminer la taille d’échantillons",
    "text": "Objectif 2: Déterminer la taille d’échantillons\nOn compte le nombre de mesures pour chaque combinaison.\ndata_count &lt;- contaminants |&gt; \n    dplyr::mutate(Year = as.integer(Year)) |&gt;\n    toxbox::uncensored(cols = \"value\", keep_cens = TRUE) |&gt;\n    dplyr::group_by(Location, Year, Species, conpound_family, variable) |&gt;\n    dplyr::summarise(n = dplyr::n(), n_censored = sum(value_censored))\nWarning: There was 1 warning in `dplyr::mutate()`.\nℹ In argument: `dplyr::across(tidyselect::all_of(cols), remove_cens)`.\nCaused by warning:\n! NAs introduced by coercion\n`summarise()` has grouped output by 'Location', 'Year', 'Species',\n'conpound_family'. You can override using the `.groups` argument.\n\ndata_count |&gt;\n    reactable::reactable()\n\n\n\n\n\n\nCriteria 1. On retire les sites pour lesquelles, il y a une seule année de collecte (impossibilité de calibrer un modèle de tendance temporelle).\nVoici la liste des sites pour lesquelles, on a une seule année de mesure\ncrit1 &lt;- contaminants |&gt; \n    dplyr::select(Location, Year) |&gt;\n    dplyr::distinct() |&gt;\n    dplyr::group_by(Location) |&gt;\n    dplyr::count() |&gt;\n    dplyr::filter(n == 1) |&gt;\n    dplyr::pull(Location)\n\ncat(paste(\"*\", crit1), sep=\"\\n\")\n\nArchipel de Mingan (approximative location)\nBeauharnois\nBetchouanes\nBonaventure\nDeslauriers\nEscuminac\nGros Pot\nIle Beauséjour\nIle Bellechasse\nIle Bienville\nIle Blanche\nIle Dodens\nIle Dowker\nIle Nue\nIle Saint-Barnabé\nIle a Bouleau de Terre\nIle aux Pommes\nIle de la Madeleine\nIle de la Mine\nIle du Petit Caoui\nIle du Petit Caouis\nIle à Calculot des Betchouanes\nIles aux Loups Marins\nIles de la Madeleine\nIlets Boisés\nIlets De Quen\nKamouraska\nKukuministuk (Caye à Cochons)\nLac Bleu\nLac Evans\nLac Saint-Bernard\nLac St-Pierre\nLac à la Carpe\nLong Island\nMiller island\nMissipinuk (Grosse Romaine)\nPetit Lac Jacques Cartier\nPetite Ile Ste-Geneviève\nPointe Saint-Pancrace\nPrairie du Castor\nRiviere George\n\nOn retire ces sites pour l’étude de la taille de l’échantillon\n\ndata_count &lt;- data_count |&gt;\n    dplyr::filter(!(Location %in% crit1)) |&gt;\n    dplyr::ungroup()\n\n\n\nSite Battures aux Loups Marins\n\n\n\nSite Bonaventure Island\n\n\n\nSite Grande Ile\n\n\n\nSite Ile Carillon\n\n\n\nSite Ile Dickerson\n\n\n\nSite Ile Eaton\n\n\n\nSite Ile Laval\n\n\n\nSite Ile Manowin\n\n\n\nSite Ile Matane\n\n\n\nSite Ile Saint-Bernard\n\n\n\nSite Ile Steamboat\n\n\n\nSite Ile Villemomble\n\n\n\nSite Ile aux Basques\n\n\n\nSite Ile aux Herons\n\n\n\nSite Ile aux Hérons\n\n\n\nSite Ile aux Oeufs\n\n\n\nSite Ile de Carillon\n\n\n\nSite Ile de la Corneille\n\n\n\nSite Ile du Bic\n\n\n\nSite Ile du Corossol\n\n\n\nSite Iles Sainte-Marie\n\n\n\nSite Maria\n\n\n\nSite Petit lac Jacques-Cartier\n\n\n\nSite Refuge Watshishou\n\n\n\nSite Yamachiche",
    "crumbs": [
      "Consolider les données",
      "Description des contaminants"
    ]
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "À quoi sert cette documentation?",
    "section": "",
    "text": "Le laboratoire de Raphael Lavoie effectue un travail d’intégration des données issues de mesure de contaminants sur des matrices biologiques pour une région d’étude couvrant l’Estuaire et le Golf du Saint-Laurent.\nCe travail d’intégration requière plusieurs étapes de validation et de consolidation des données. Ce document recense l’ensembles des étapes qui ont mener vers la construction de la base de données. Il rassemble également le code permettant de générer certaines figures exploratoires pour bien comprendre les données.",
    "crumbs": [
      "Introduction",
      "À quoi sert cette documentation?"
    ]
  },
  {
    "objectID": "deploy.html",
    "href": "deploy.html",
    "title": "Contribuer à cette documentation",
    "section": "",
    "text": "Pour construire cette documentation en locale, voici les étapes.",
    "crumbs": [
      "Introduction",
      "Contribuer à cette documentation"
    ]
  },
  {
    "objectID": "deploy.html#pré-requis",
    "href": "deploy.html#pré-requis",
    "title": "Contribuer à cette documentation",
    "section": "Pré-requis",
    "text": "Pré-requis\nInstaller les deux librairies R à l’aide des commandes suivantes:\n# install.packages(\"devtools\")\ndevtools::install_github(\"ECCC-lavoie-ecotox/toxbox\")\ninstall.packages(\"quarto\")",
    "crumbs": [
      "Introduction",
      "Contribuer à cette documentation"
    ]
  },
  {
    "objectID": "deploy.html#téleverser-le-code-source-sur-votre-poste-de-travail",
    "href": "deploy.html#téleverser-le-code-source-sur-votre-poste-de-travail",
    "title": "Contribuer à cette documentation",
    "section": "Téleverser le code source sur votre poste de travail",
    "text": "Téleverser le code source sur votre poste de travail\nTODO",
    "crumbs": [
      "Introduction",
      "Contribuer à cette documentation"
    ]
  },
  {
    "objectID": "deploy.html#construire-ce-site-internet",
    "href": "deploy.html#construire-ce-site-internet",
    "title": "Contribuer à cette documentation",
    "section": "Construire ce site internet",
    "text": "Construire ce site internet\n# Serve the website in your browser\nquarto::quarto_preview()\nCette approche permet de travailler en parallele sur les fichiers de documentation. À chaque fois qu’un fichier est modifié, le site internet est reconstruit pour inclure les dernières modifications.",
    "crumbs": [
      "Introduction",
      "Contribuer à cette documentation"
    ]
  },
  {
    "objectID": "tbl_analytes.html",
    "href": "tbl_analytes.html",
    "title": "Consolidation de la nomenclature des analytes",
    "section": "",
    "text": "Nous désirons consolider la nomenclature des analytes. On peut observer plusieurs divergences dans la facon de nommer les analytes, exemple PCB-17 ou PCB 17. Cette section documente la démarche pour tendre vers une réconciliation des termes utilisés.\nOn charge les données intégrées depuis le package toxbox. Les données ne sont pas entreposées dans le package, la function toxbox::dbs_integration() permet de lire les fichiers Excels entreposées sur le disque réseau Z: et les fusionne dans un seul data.frame. Il faut pour cela que le VPN soit ouvert, si vous n’êtes pas directement sur le réseau d’environnement canada.\ndevtools::install_github(\"ECCC-lavoie-ecotox/toxbox\")\n\nSkipping install of 'toxbox' from a github remote, the SHA1 (b95a07f6) has not changed since last install.\n  Use `force = TRUE` to force installation\nmeasurements &lt;- toxbox::dbs_integration()",
    "crumbs": [
      "Consolider les données",
      "Consolidation de la nomenclature des analytes"
    ]
  },
  {
    "objectID": "tbl_analytes.html#analytes-avec-un-numéro-cas-fournis-par-le-laboratoire",
    "href": "tbl_analytes.html#analytes-avec-un-numéro-cas-fournis-par-le-laboratoire",
    "title": "Consolidation de la nomenclature des analytes",
    "section": "Analytes avec un numéro CAS fournis par le laboratoire",
    "text": "Analytes avec un numéro CAS fournis par le laboratoire\nLa nomenclature des composées chimiques / analytes peut diverger d’un laboratoire à un autre. Chaque pays dispose également de sa propre nomenclature (ex. États-Unis, Allemagne, Royaume-Unis). Afin de reconcilier la nomenclature, nous souhaitons utiliser un identifiant unique international tel que l’International Chemical Identifier (InChl).\nDans un premier temps, on charge les données sur les analytes (incluant le CAS) fournies par les laboratoires. Le fichier analytes_consolidation_27032024 est la fusion des onglets Analyte Information des différentes base de données. On fusionne les données sur les analytes avec les mesures.\n\nanalytes &lt;- readxl::read_excel(\"Z:/07-Données BD/TBL_analytes/analytes_consolidation_27032024.xlsx\") |&gt;\n    dplyr::select(Analyte, CASNumber) |&gt;\n    dplyr::filter(!is.na(CASNumber)) |&gt;\n    dplyr::mutate(\n        key = janitor::make_clean_names(Analyte, allow_dupes = TRUE, case = \"none\") |&gt; tolower()\n    ) |&gt;\n    dplyr::distinct()\n\nmeasurements &lt;- measurements |&gt; \n    dplyr::mutate(\n        key = stringr::str_replace(variable, \"PCB-|PCB \", \"PCB\") |&gt;\n            janitor::make_clean_names(allow_dupes = TRUE, case = \"none\") |&gt; tolower()\n    )\n\nmeasurements &lt;-  measurements |&gt;\n    dplyr::left_join(analytes, by = \"key\")\n\nOn isole le nom des contaminants pour lesquels nous n’avons pas de CAS associés. Voici la liste de ces contaminants:\ncontaminants_orphelins &lt;- measurements |&gt; \n    dplyr::filter(is.na(CASNumber)) |&gt;\n    dplyr::select(key, variable, CASNumber) |&gt;\n    dplyr::distinct()\n\nreactable::reactable(contaminants_orphelins, searchable = TRUE)",
    "crumbs": [
      "Consolider les données",
      "Consolidation de la nomenclature des analytes"
    ]
  },
  {
    "objectID": "tbl_analytes.html#obtention-du-numéro-de-cas-par-le-service-cts",
    "href": "tbl_analytes.html#obtention-du-numéro-de-cas-par-le-service-cts",
    "title": "Consolidation de la nomenclature des analytes",
    "section": "Obtention du numéro de CAS par le service CTS",
    "text": "Obtention du numéro de CAS par le service CTS\nLa fonction webchem::cts_convert() permet d’interroger plusieurs base de données et d’extraire des identifiants tels que le CAS à partir du nom d’un composé chimique.\n\ncas_from_cts &lt;- webchem::cts_convert(contaminants_orphelins$variable, from = \"Chemical Name\", to = \"CAS\")\n\ncas &lt;- purrr::map2_df(names(cas_from_cts), cas_from_cts, \\(n, c){\n    return(data.frame(variable = n, CASNumber = c))\n})\n\nreactable::reactable(cas, searchable = TRUE)\n\nEn cherchant le numéro CAS avec le nom du composé, on s’apercoit que plusieurs PCB (ex. PCB 60 et 64) tombent sous le même CAS, ce qui est incorrect. On change donc d’approche puisque le service CTS ne semblent pas être un bon service de résolution par le nom.",
    "crumbs": [
      "Consolider les données",
      "Consolidation de la nomenclature des analytes"
    ]
  },
  {
    "objectID": "tbl_analytes.html#obtention-du-numéro-de-cas-par-le-service-chemspider",
    "href": "tbl_analytes.html#obtention-du-numéro-de-cas-par-le-service-chemspider",
    "title": "Consolidation de la nomenclature des analytes",
    "section": "Obtention du numéro de CAS par le service ChemSpider",
    "text": "Obtention du numéro de CAS par le service ChemSpider\n\ncsid &lt;- webchem::get_csid(contaminants_orphelins$variable, from = \"name\") \n\ncsid &lt;- csid |&gt; dplyr::rename(variable = query) |&gt; \n    dplyr::left_join(\n        dplyr::select(contaminants_orphelins, key, variable)\n    ) |&gt; \n    dplyr::filter(!is.na(csid)) |&gt;\n    dplyr::mutate(csid = as.character(csid))\n\ncas_from_csid &lt;- webchem::cts_convert(csid$csid, from = \"ChemSpider\", to = \"CAS\")\ncas2 &lt;- purrr::map2_df(names(cas_from_csid), cas_from_csid, \\(n, c){\n        return(data.frame(csid = n, CASNumber = c))\n    }) |&gt; \n    dplyr::left_join(csid, by = \"csid\")\n\nreactable::reactable(cas2, searchable = TRUE)\n\nEffectuer la résolution de la nomenclature des composées par l’utilisation du service ChemSpider semble plus prometteur. Après une vérification visuelle, on voit que les composées ne présentent plus d’identifiant unique identique.",
    "crumbs": [
      "Consolider les données",
      "Consolidation de la nomenclature des analytes"
    ]
  },
  {
    "objectID": "tbl_analytes.html#enrichissement-des-données-ajout-de-lidentifiant-pubchem",
    "href": "tbl_analytes.html#enrichissement-des-données-ajout-de-lidentifiant-pubchem",
    "title": "Consolidation de la nomenclature des analytes",
    "section": "Enrichissement des données: Ajout de l’identifiant PubChem",
    "text": "Enrichissement des données: Ajout de l’identifiant PubChem\nAfin de permettre le retrait d’informations supplémentaires sur les composées chimiques, une des base de données d’intérêt est PubChem. À partir de cette base de données, on peut effectuer le retrait de certaines propriétés chimiques du composée telle que la masse moléculaire par exemple.",
    "crumbs": [
      "Consolider les données",
      "Consolidation de la nomenclature des analytes"
    ]
  },
  {
    "objectID": "tbl_analytes.html#obtention-du-numéro-de-cas-par-le-service-chemspider-1",
    "href": "tbl_analytes.html#obtention-du-numéro-de-cas-par-le-service-chemspider-1",
    "title": "Consolidation de la nomenclature des analytes",
    "section": "Obtention du numéro de CAS par le service ChemSpider",
    "text": "Obtention du numéro de CAS par le service ChemSpider\n\nanalytes_nomenclature &lt;- dplyr::select(measurements, variable) |&gt; dplyr::distinct() |&gt; dplyr::pull()\nanalytes_pubchem_ids &lt;- webchem::get_cid(sample(analytes_nomenclature, size = 20))\nPubChemR::get_json(5281116)\n\n$PC_Compounds\n$PC_Compounds[[1]]\n$PC_Compounds[[1]]$id\n$PC_Compounds[[1]]$id$id\n    cid \n5281116 \n\n\n$PC_Compounds[[1]]$atoms\n$PC_Compounds[[1]]$atoms$aid\n [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25\n[26] 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50\n[51] 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66\n\n$PC_Compounds[[1]]$atoms$element\n [1] 8 8 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n[39] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n\n\n$PC_Compounds[[1]]$bonds\n$PC_Compounds[[1]]$bonds$aid1\n [1]  1  1  2  3  3  3  3  4  4  4  5  5  5  6  6  6  7  7  7  8  8  8  9  9  9\n[26] 10 10 10 11 11 11 11 12 12 12 13 13 13 14 14 14 15 15 15 16 16 16 17 17 17\n[51] 18 18 18 19 19 20 21 21 21 22 22 22 23 23 23\n\n$PC_Compounds[[1]]$bonds$aid2\n [1] 24 66 24  4  5 25 26  6 27 28  7 29 30  8 31 32  9 33 34 10 35 36 13 37 38\n[26] 16 39 40 12 14 41 42 15 43 44 19 47 48 18 45 46 17 49 50 21 51 52 20 53 54\n[51] 22 55 56 20 57 58 24 59 60 23 61 62 63 64 65\n\n$PC_Compounds[[1]]$bonds$order\n [1] 1 1 2 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n[39] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 1 1 1 1 1 1 1 1 1 1 1\n\n\n$PC_Compounds[[1]]$stereo\n$PC_Compounds[[1]]$stereo[[1]]\n$PC_Compounds[[1]]$stereo[[1]]$planar\n   left    ltop lbottom   right    rtop rbottom  parity    type \n     19      13      57      20      17      58       1       1 \n\n\n\n$PC_Compounds[[1]]$coords\n$PC_Compounds[[1]]$coords[[1]]\n$PC_Compounds[[1]]$coords[[1]]$type\n[1]   1   5 255\n\n$PC_Compounds[[1]]$coords[[1]]$aid\n [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25\n[26] 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50\n[51] 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66\n\n$PC_Compounds[[1]]$coords[[1]]$conformers\n$PC_Compounds[[1]]$coords[[1]]$conformers[[1]]\n$PC_Compounds[[1]]$coords[[1]]$conformers[[1]]$x\n [1]  2.5369  3.4030  9.4651  8.5991 10.3312  7.7331 11.1972  6.8671 12.0632\n[10]  6.0010 16.3933 15.5273 12.9292 16.3933 15.5273  5.1350 14.6613 17.2594\n[19] 13.7953 14.6613  4.2690 17.2594 18.1254  3.4030  9.8637  9.0666  8.2006\n[28]  8.9976  9.9326 10.7297  8.1316  7.3346 11.5957 10.7987  6.4685  7.2656\n[37] 11.6647 12.4617  6.3996  5.6025 16.6054 17.0039 15.3153 14.9167 16.1813\n[46] 15.7828 13.3278 12.5307 15.7394 16.1379  4.7365  5.5335 14.4492 14.0507\n[55] 17.4714 17.8699 13.7953 15.1982  4.6675  3.8705 17.0473 16.6488 18.4354\n[64] 18.6623 17.8154  2.0000\n\n$PC_Compounds[[1]]$coords[[1]]$conformers[[1]]$y\n [1] -2.2500 -3.7500 -2.2500 -2.7500 -2.7500 -2.2500 -2.2500 -2.7500 -2.7500\n[10] -2.2500  0.7500  0.2500 -2.2500  1.7500 -0.7500 -2.7500 -1.2500  2.2500\n[19] -2.7500 -2.2500 -2.2500  3.2500  3.7500 -2.7500 -1.7750 -1.7750 -3.2250\n[28] -3.2250 -3.2250 -3.2250 -1.7750 -1.7750 -1.7750 -1.7750 -3.2250 -3.2250\n[37] -3.2250 -3.2250 -1.7750 -1.7750  0.1674  0.8577  0.8326  0.1423  2.3326\n[46]  1.6423 -1.7750 -1.7750 -1.3326 -0.6423 -3.2250 -3.2250 -0.6674 -1.3577\n[55]  1.6674  2.3577 -3.3700 -2.5600 -1.7750 -1.7750  3.8326  3.1423  3.2131\n[64]  4.0600  4.2869 -2.5600\n\n\n\n\n\n$PC_Compounds[[1]]$charge\n[1] 0\n\n$PC_Compounds[[1]]$props\n$PC_Compounds[[1]]$props[[1]]\n$PC_Compounds[[1]]$props[[1]]$urn\n$PC_Compounds[[1]]$props[[1]]$urn$label\n[1] \"Compound\"\n\n$PC_Compounds[[1]]$props[[1]]$urn$name\n[1] \"Canonicalized\"\n\n$PC_Compounds[[1]]$props[[1]]$urn$datatype\n[1] 5\n\n$PC_Compounds[[1]]$props[[1]]$urn$release\n[1] \"2021.10.14\"\n\n\n$PC_Compounds[[1]]$props[[1]]$value\nival \n   1 \n\n\n$PC_Compounds[[1]]$props[[2]]\n$PC_Compounds[[1]]$props[[2]]$urn\n$PC_Compounds[[1]]$props[[2]]$urn$label\n[1] \"Compound Complexity\"\n\n$PC_Compounds[[1]]$props[[2]]$urn$datatype\n[1] 7\n\n$PC_Compounds[[1]]$props[[2]]$urn$implementation\n[1] \"E_COMPLEXITY\"\n\n$PC_Compounds[[1]]$props[[2]]$urn$version\n[1] \"3.4.8.18\"\n\n$PC_Compounds[[1]]$props[[2]]$urn$software\n[1] \"Cactvs\"\n\n$PC_Compounds[[1]]$props[[2]]$urn$source\n[1] \"Xemistry GmbH\"\n\n$PC_Compounds[[1]]$props[[2]]$urn$release\n[1] \"2021.10.14\"\n\n\n$PC_Compounds[[1]]$props[[2]]$value\nfval \n 284 \n\n\n$PC_Compounds[[1]]$props[[3]]\n$PC_Compounds[[1]]$props[[3]]$urn\n$PC_Compounds[[1]]$props[[3]]$urn$label\n[1] \"Count\"\n\n$PC_Compounds[[1]]$props[[3]]$urn$name\n[1] \"Hydrogen Bond Acceptor\"\n\n$PC_Compounds[[1]]$props[[3]]$urn$datatype\n[1] 5\n\n$PC_Compounds[[1]]$props[[3]]$urn$implementation\n[1] \"E_NHACCEPTORS\"\n\n$PC_Compounds[[1]]$props[[3]]$urn$version\n[1] \"3.4.8.18\"\n\n$PC_Compounds[[1]]$props[[3]]$urn$software\n[1] \"Cactvs\"\n\n$PC_Compounds[[1]]$props[[3]]$urn$source\n[1] \"Xemistry GmbH\"\n\n$PC_Compounds[[1]]$props[[3]]$urn$release\n[1] \"2021.10.14\"\n\n\n$PC_Compounds[[1]]$props[[3]]$value\nival \n   2 \n\n\n$PC_Compounds[[1]]$props[[4]]\n$PC_Compounds[[1]]$props[[4]]$urn\n$PC_Compounds[[1]]$props[[4]]$urn$label\n[1] \"Count\"\n\n$PC_Compounds[[1]]$props[[4]]$urn$name\n[1] \"Hydrogen Bond Donor\"\n\n$PC_Compounds[[1]]$props[[4]]$urn$datatype\n[1] 5\n\n$PC_Compounds[[1]]$props[[4]]$urn$implementation\n[1] \"E_NHDONORS\"\n\n$PC_Compounds[[1]]$props[[4]]$urn$version\n[1] \"3.4.8.18\"\n\n$PC_Compounds[[1]]$props[[4]]$urn$software\n[1] \"Cactvs\"\n\n$PC_Compounds[[1]]$props[[4]]$urn$source\n[1] \"Xemistry GmbH\"\n\n$PC_Compounds[[1]]$props[[4]]$urn$release\n[1] \"2021.10.14\"\n\n\n$PC_Compounds[[1]]$props[[4]]$value\nival \n   1 \n\n\n$PC_Compounds[[1]]$props[[5]]\n$PC_Compounds[[1]]$props[[5]]$urn\n$PC_Compounds[[1]]$props[[5]]$urn$label\n[1] \"Count\"\n\n$PC_Compounds[[1]]$props[[5]]$urn$name\n[1] \"Rotatable Bond\"\n\n$PC_Compounds[[1]]$props[[5]]$urn$datatype\n[1] 5\n\n$PC_Compounds[[1]]$props[[5]]$urn$implementation\n[1] \"E_NROTBONDS\"\n\n$PC_Compounds[[1]]$props[[5]]$urn$version\n[1] \"3.4.8.18\"\n\n$PC_Compounds[[1]]$props[[5]]$urn$software\n[1] \"Cactvs\"\n\n$PC_Compounds[[1]]$props[[5]]$urn$source\n[1] \"Xemistry GmbH\"\n\n$PC_Compounds[[1]]$props[[5]]$urn$release\n[1] \"2021.10.14\"\n\n\n$PC_Compounds[[1]]$props[[5]]$value\nival \n  19 \n\n\n$PC_Compounds[[1]]$props[[6]]\n$PC_Compounds[[1]]$props[[6]]$urn\n$PC_Compounds[[1]]$props[[6]]$urn$label\n[1] \"Fingerprint\"\n\n$PC_Compounds[[1]]$props[[6]]$urn$name\n[1] \"SubStructure Keys\"\n\n$PC_Compounds[[1]]$props[[6]]$urn$datatype\n[1] 16\n\n$PC_Compounds[[1]]$props[[6]]$urn$parameters\n[1] \"extended 2\"\n\n$PC_Compounds[[1]]$props[[6]]$urn$implementation\n[1] \"E_SCREEN\"\n\n$PC_Compounds[[1]]$props[[6]]$urn$version\n[1] \"3.4.8.18\"\n\n$PC_Compounds[[1]]$props[[6]]$urn$software\n[1] \"Cactvs\"\n\n$PC_Compounds[[1]]$props[[6]]$urn$source\n[1] \"Xemistry GmbH\"\n\n$PC_Compounds[[1]]$props[[6]]$urn$release\n[1] \"2021.10.14\"\n\n\n$PC_Compounds[[1]]$props[[6]]$value\n                                                                                                                                                                                                                                  binary \n\"00000371F0783000000000000000000000000000000000000000000000000000000000000000001A00000800000800808000020800000200880020D2080000000020000008080100000800001200010000400004800008000388C8A08000000000000000000000000000000000000000000000\" \n\n\n$PC_Compounds[[1]]$props[[7]]\n$PC_Compounds[[1]]$props[[7]]$urn\n$PC_Compounds[[1]]$props[[7]]$urn$label\n[1] \"IUPAC Name\"\n\n$PC_Compounds[[1]]$props[[7]]$urn$name\n[1] \"Allowed\"\n\n$PC_Compounds[[1]]$props[[7]]$urn$datatype\n[1] 1\n\n$PC_Compounds[[1]]$props[[7]]$urn$version\n[1] \"2.7.0\"\n\n$PC_Compounds[[1]]$props[[7]]$urn$software\n[1] \"Lexichem TK\"\n\n$PC_Compounds[[1]]$props[[7]]$urn$source\n[1] \"OpenEye Scientific Software\"\n\n$PC_Compounds[[1]]$props[[7]]$urn$release\n[1] \"2021.10.14\"\n\n\n$PC_Compounds[[1]]$props[[7]]$value\n                     sval \n\"(Z)-docos-13-enoic acid\" \n\n\n$PC_Compounds[[1]]$props[[8]]\n$PC_Compounds[[1]]$props[[8]]$urn\n$PC_Compounds[[1]]$props[[8]]$urn$label\n[1] \"IUPAC Name\"\n\n$PC_Compounds[[1]]$props[[8]]$urn$name\n[1] \"CAS-like Style\"\n\n$PC_Compounds[[1]]$props[[8]]$urn$datatype\n[1] 1\n\n$PC_Compounds[[1]]$props[[8]]$urn$version\n[1] \"2.7.0\"\n\n$PC_Compounds[[1]]$props[[8]]$urn$software\n[1] \"Lexichem TK\"\n\n$PC_Compounds[[1]]$props[[8]]$urn$source\n[1] \"OpenEye Scientific Software\"\n\n$PC_Compounds[[1]]$props[[8]]$urn$release\n[1] \"2021.10.14\"\n\n\n$PC_Compounds[[1]]$props[[8]]$value\n                    sval \n\"(Z)-13-docosenoic acid\" \n\n\n$PC_Compounds[[1]]$props[[9]]\n$PC_Compounds[[1]]$props[[9]]$urn\n$PC_Compounds[[1]]$props[[9]]$urn$label\n[1] \"IUPAC Name\"\n\n$PC_Compounds[[1]]$props[[9]]$urn$name\n[1] \"Markup\"\n\n$PC_Compounds[[1]]$props[[9]]$urn$datatype\n[1] 1\n\n$PC_Compounds[[1]]$props[[9]]$urn$version\n[1] \"2.7.0\"\n\n$PC_Compounds[[1]]$props[[9]]$urn$software\n[1] \"Lexichem TK\"\n\n$PC_Compounds[[1]]$props[[9]]$urn$source\n[1] \"OpenEye Scientific Software\"\n\n$PC_Compounds[[1]]$props[[9]]$urn$release\n[1] \"2021.10.14\"\n\n\n$PC_Compounds[[1]]$props[[9]]$value\n                            sval \n\"(&lt;I&gt;Z&lt;/I&gt;)-docos-13-enoic acid\" \n\n\n$PC_Compounds[[1]]$props[[10]]\n$PC_Compounds[[1]]$props[[10]]$urn\n$PC_Compounds[[1]]$props[[10]]$urn$label\n[1] \"IUPAC Name\"\n\n$PC_Compounds[[1]]$props[[10]]$urn$name\n[1] \"Preferred\"\n\n$PC_Compounds[[1]]$props[[10]]$urn$datatype\n[1] 1\n\n$PC_Compounds[[1]]$props[[10]]$urn$version\n[1] \"2.7.0\"\n\n$PC_Compounds[[1]]$props[[10]]$urn$software\n[1] \"Lexichem TK\"\n\n$PC_Compounds[[1]]$props[[10]]$urn$source\n[1] \"OpenEye Scientific Software\"\n\n$PC_Compounds[[1]]$props[[10]]$urn$release\n[1] \"2021.10.14\"\n\n\n$PC_Compounds[[1]]$props[[10]]$value\n                     sval \n\"(Z)-docos-13-enoic acid\" \n\n\n$PC_Compounds[[1]]$props[[11]]\n$PC_Compounds[[1]]$props[[11]]$urn\n$PC_Compounds[[1]]$props[[11]]$urn$label\n[1] \"IUPAC Name\"\n\n$PC_Compounds[[1]]$props[[11]]$urn$name\n[1] \"Systematic\"\n\n$PC_Compounds[[1]]$props[[11]]$urn$datatype\n[1] 1\n\n$PC_Compounds[[1]]$props[[11]]$urn$version\n[1] \"2.7.0\"\n\n$PC_Compounds[[1]]$props[[11]]$urn$software\n[1] \"Lexichem TK\"\n\n$PC_Compounds[[1]]$props[[11]]$urn$source\n[1] \"OpenEye Scientific Software\"\n\n$PC_Compounds[[1]]$props[[11]]$urn$release\n[1] \"2021.10.14\"\n\n\n$PC_Compounds[[1]]$props[[11]]$value\n                     sval \n\"(Z)-docos-13-enoic acid\" \n\n\n$PC_Compounds[[1]]$props[[12]]\n$PC_Compounds[[1]]$props[[12]]$urn\n$PC_Compounds[[1]]$props[[12]]$urn$label\n[1] \"IUPAC Name\"\n\n$PC_Compounds[[1]]$props[[12]]$urn$name\n[1] \"Traditional\"\n\n$PC_Compounds[[1]]$props[[12]]$urn$datatype\n[1] 1\n\n$PC_Compounds[[1]]$props[[12]]$urn$version\n[1] \"2.7.0\"\n\n$PC_Compounds[[1]]$props[[12]]$urn$software\n[1] \"Lexichem TK\"\n\n$PC_Compounds[[1]]$props[[12]]$urn$source\n[1] \"OpenEye Scientific Software\"\n\n$PC_Compounds[[1]]$props[[12]]$urn$release\n[1] \"2021.10.14\"\n\n\n$PC_Compounds[[1]]$props[[12]]$value\n         sval \n\"erucic acid\" \n\n\n$PC_Compounds[[1]]$props[[13]]\n$PC_Compounds[[1]]$props[[13]]$urn\n$PC_Compounds[[1]]$props[[13]]$urn$label\n[1] \"InChI\"\n\n$PC_Compounds[[1]]$props[[13]]$urn$name\n[1] \"Standard\"\n\n$PC_Compounds[[1]]$props[[13]]$urn$datatype\n[1] 1\n\n$PC_Compounds[[1]]$props[[13]]$urn$version\n[1] \"1.0.6\"\n\n$PC_Compounds[[1]]$props[[13]]$urn$software\n[1] \"InChI\"\n\n$PC_Compounds[[1]]$props[[13]]$urn$source\n[1] \"iupac.org\"\n\n$PC_Compounds[[1]]$props[[13]]$urn$release\n[1] \"2021.10.14\"\n\n\n$PC_Compounds[[1]]$props[[13]]$value\n                                                                                                                       sval \n\"InChI=1S/C22H42O2/c1-2-3-4-5-6-7-8-9-10-11-12-13-14-15-16-17-18-19-20-21-22(23)24/h9-10H,2-8,11-21H2,1H3,(H,23,24)/b10-9-\" \n\n\n$PC_Compounds[[1]]$props[[14]]\n$PC_Compounds[[1]]$props[[14]]$urn\n$PC_Compounds[[1]]$props[[14]]$urn$label\n[1] \"InChIKey\"\n\n$PC_Compounds[[1]]$props[[14]]$urn$name\n[1] \"Standard\"\n\n$PC_Compounds[[1]]$props[[14]]$urn$datatype\n[1] 1\n\n$PC_Compounds[[1]]$props[[14]]$urn$version\n[1] \"1.0.6\"\n\n$PC_Compounds[[1]]$props[[14]]$urn$software\n[1] \"InChI\"\n\n$PC_Compounds[[1]]$props[[14]]$urn$source\n[1] \"iupac.org\"\n\n$PC_Compounds[[1]]$props[[14]]$urn$release\n[1] \"2021.10.14\"\n\n\n$PC_Compounds[[1]]$props[[14]]$value\n                         sval \n\"DPUOLQHDNGRHBS-KTKRTIGZSA-N\" \n\n\n$PC_Compounds[[1]]$props[[15]]\n$PC_Compounds[[1]]$props[[15]]$urn\n$PC_Compounds[[1]]$props[[15]]$urn$label\n[1] \"Log P\"\n\n$PC_Compounds[[1]]$props[[15]]$urn$name\n[1] \"XLogP3\"\n\n$PC_Compounds[[1]]$props[[15]]$urn$datatype\n[1] 7\n\n$PC_Compounds[[1]]$props[[15]]$urn$version\n[1] \"3.0\"\n\n$PC_Compounds[[1]]$props[[15]]$urn$source\n[1] \"sioc-ccbg.ac.cn\"\n\n$PC_Compounds[[1]]$props[[15]]$urn$release\n[1] \"2021.10.14\"\n\n\n$PC_Compounds[[1]]$props[[15]]$value\nfval \n 8.7 \n\n\n$PC_Compounds[[1]]$props[[16]]\n$PC_Compounds[[1]]$props[[16]]$urn\n$PC_Compounds[[1]]$props[[16]]$urn$label\n[1] \"Mass\"\n\n$PC_Compounds[[1]]$props[[16]]$urn$name\n[1] \"Exact\"\n\n$PC_Compounds[[1]]$props[[16]]$urn$datatype\n[1] 1\n\n$PC_Compounds[[1]]$props[[16]]$urn$version\n[1] \"2.2\"\n\n$PC_Compounds[[1]]$props[[16]]$urn$software\n[1] \"PubChem\"\n\n$PC_Compounds[[1]]$props[[16]]$urn$source\n[1] \"ncbi.nlm.nih.gov\"\n\n$PC_Compounds[[1]]$props[[16]]$urn$release\n[1] \"2021.10.14\"\n\n\n$PC_Compounds[[1]]$props[[16]]$value\n           sval \n\"338.318480578\" \n\n\n$PC_Compounds[[1]]$props[[17]]\n$PC_Compounds[[1]]$props[[17]]$urn\n$PC_Compounds[[1]]$props[[17]]$urn$label\n[1] \"Molecular Formula\"\n\n$PC_Compounds[[1]]$props[[17]]$urn$datatype\n[1] 1\n\n$PC_Compounds[[1]]$props[[17]]$urn$version\n[1] \"2.2\"\n\n$PC_Compounds[[1]]$props[[17]]$urn$software\n[1] \"PubChem\"\n\n$PC_Compounds[[1]]$props[[17]]$urn$source\n[1] \"ncbi.nlm.nih.gov\"\n\n$PC_Compounds[[1]]$props[[17]]$urn$release\n[1] \"2021.10.14\"\n\n\n$PC_Compounds[[1]]$props[[17]]$value\n      sval \n\"C22H42O2\" \n\n\n$PC_Compounds[[1]]$props[[18]]\n$PC_Compounds[[1]]$props[[18]]$urn\n$PC_Compounds[[1]]$props[[18]]$urn$label\n[1] \"Molecular Weight\"\n\n$PC_Compounds[[1]]$props[[18]]$urn$datatype\n[1] 1\n\n$PC_Compounds[[1]]$props[[18]]$urn$version\n[1] \"2.2\"\n\n$PC_Compounds[[1]]$props[[18]]$urn$software\n[1] \"PubChem\"\n\n$PC_Compounds[[1]]$props[[18]]$urn$source\n[1] \"ncbi.nlm.nih.gov\"\n\n$PC_Compounds[[1]]$props[[18]]$urn$release\n[1] \"2021.10.14\"\n\n\n$PC_Compounds[[1]]$props[[18]]$value\n   sval \n\"338.6\" \n\n\n$PC_Compounds[[1]]$props[[19]]\n$PC_Compounds[[1]]$props[[19]]$urn\n$PC_Compounds[[1]]$props[[19]]$urn$label\n[1] \"SMILES\"\n\n$PC_Compounds[[1]]$props[[19]]$urn$name\n[1] \"Canonical\"\n\n$PC_Compounds[[1]]$props[[19]]$urn$datatype\n[1] 1\n\n$PC_Compounds[[1]]$props[[19]]$urn$version\n[1] \"2.3.0\"\n\n$PC_Compounds[[1]]$props[[19]]$urn$software\n[1] \"OEChem\"\n\n$PC_Compounds[[1]]$props[[19]]$urn$source\n[1] \"OpenEye Scientific Software\"\n\n$PC_Compounds[[1]]$props[[19]]$urn$release\n[1] \"2021.10.14\"\n\n\n$PC_Compounds[[1]]$props[[19]]$value\n                          sval \n\"CCCCCCCCC=CCCCCCCCCCCCC(=O)O\" \n\n\n$PC_Compounds[[1]]$props[[20]]\n$PC_Compounds[[1]]$props[[20]]$urn\n$PC_Compounds[[1]]$props[[20]]$urn$label\n[1] \"SMILES\"\n\n$PC_Compounds[[1]]$props[[20]]$urn$name\n[1] \"Isomeric\"\n\n$PC_Compounds[[1]]$props[[20]]$urn$datatype\n[1] 1\n\n$PC_Compounds[[1]]$props[[20]]$urn$version\n[1] \"2.3.0\"\n\n$PC_Compounds[[1]]$props[[20]]$urn$software\n[1] \"OEChem\"\n\n$PC_Compounds[[1]]$props[[20]]$urn$source\n[1] \"OpenEye Scientific Software\"\n\n$PC_Compounds[[1]]$props[[20]]$urn$release\n[1] \"2021.10.14\"\n\n\n$PC_Compounds[[1]]$props[[20]]$value\n                             sval \n\"CCCCCCCC/C=C\\\\CCCCCCCCCCCC(=O)O\" \n\n\n$PC_Compounds[[1]]$props[[21]]\n$PC_Compounds[[1]]$props[[21]]$urn\n$PC_Compounds[[1]]$props[[21]]$urn$label\n[1] \"Topological\"\n\n$PC_Compounds[[1]]$props[[21]]$urn$name\n[1] \"Polar Surface Area\"\n\n$PC_Compounds[[1]]$props[[21]]$urn$datatype\n[1] 7\n\n$PC_Compounds[[1]]$props[[21]]$urn$implementation\n[1] \"E_TPSA\"\n\n$PC_Compounds[[1]]$props[[21]]$urn$version\n[1] \"3.4.8.18\"\n\n$PC_Compounds[[1]]$props[[21]]$urn$software\n[1] \"Cactvs\"\n\n$PC_Compounds[[1]]$props[[21]]$urn$source\n[1] \"Xemistry GmbH\"\n\n$PC_Compounds[[1]]$props[[21]]$urn$release\n[1] \"2021.10.14\"\n\n\n$PC_Compounds[[1]]$props[[21]]$value\nfval \n37.3 \n\n\n$PC_Compounds[[1]]$props[[22]]\n$PC_Compounds[[1]]$props[[22]]$urn\n$PC_Compounds[[1]]$props[[22]]$urn$label\n[1] \"Weight\"\n\n$PC_Compounds[[1]]$props[[22]]$urn$name\n[1] \"MonoIsotopic\"\n\n$PC_Compounds[[1]]$props[[22]]$urn$datatype\n[1] 1\n\n$PC_Compounds[[1]]$props[[22]]$urn$version\n[1] \"2.2\"\n\n$PC_Compounds[[1]]$props[[22]]$urn$software\n[1] \"PubChem\"\n\n$PC_Compounds[[1]]$props[[22]]$urn$source\n[1] \"ncbi.nlm.nih.gov\"\n\n$PC_Compounds[[1]]$props[[22]]$urn$release\n[1] \"2021.10.14\"\n\n\n$PC_Compounds[[1]]$props[[22]]$value\n           sval \n\"338.318480578\" \n\n\n\n$PC_Compounds[[1]]$count\n       heavy_atom       atom_chiral   atom_chiral_def atom_chiral_undef \n               24                 0                 0                 0 \n      bond_chiral   bond_chiral_def bond_chiral_undef      isotope_atom \n                1                 1                 0                 0 \n    covalent_unit         tautomers \n                1                -1",
    "crumbs": [
      "Consolider les données",
      "Consolidation de la nomenclature des analytes"
    ]
  },
  {
    "objectID": "tbl_projects.html",
    "href": "tbl_projects.html",
    "title": "Recensement des projets",
    "section": "",
    "text": "Chaque rapport de laboratoire contient sur sa page de garde l’ensemble des métadonnées en lien avec le projet de recherche pour lequel cette analyse a été demandé. On désire donc extraire la page de garde de chacun des rapports de laboratoires afin d’obtenir la liste des projets.\nUn rapport de laboratoire peut être detectable dans une liste de fichier par la structure de son identifiant unique. Voici un exemple d’identifiant unique: CHEM-PCDD-00-07 ou encore MB-05-10. Ces identifiants ont une structure unique que l’on peut detecter grace à l’expression régulière suivante:\n\nregex_report_id &lt;- \"([A-Za-z]{2,5}-)?[A-Za-z]{2,5}-\\\\d{2}-\\\\d{2}\"\n\nLa variable regex_report_id sera utilisée plusieurs fois dans ce document.\nOn liste les rapports de laboratoire présents dans le dossier 03-Labo/Results Reports.\n\nreports_path &lt;- list.files(\n    \"C:/Users/VissaultS/Documents/03-Labo/Results Reports\", \n    pattern = \"*.pdf|*.docx|*.doc\", recursive = TRUE, full.names = TRUE\n)\n\n# On extrait les identifiants des rapports du nom du fichier\nreport_id &lt;- stringr::str_extract(reports_path, regex_report_id)\n\n# On obtient la signature du fichier, ca va être pratique pour detecter les fichiers dupliqués même si le nom du fichier est différent.\nfile_hash &lt;- tools::md5sum(reports_path)\n\n# On extrait l'extension du fichier\nfile_ext &lt;- reports_path |&gt; \n    strsplit(\"[.]\") |&gt; \n    purrr::map_chr(\\(e) return(e[2]))\n\n# On compose un tableau avec l'ensemble de ces informations\nreports &lt;- data.frame(\n        path = reports_path, \n        id = report_id, \n        hash = file_hash, \n        ext = file_ext\n    ) |&gt; tibble::as_tibble()\n\nNote: tools::md5sum permet de générer une signature unique propre au fichier. Ainsi deux fichiers identiques dans le contenu mais avec des noms différents pourront être identifié comme des duplicats.\nVoici la liste des fichiers identiques dans le dossier 03-Labo/Results Reports.\nreports_dup &lt;- reports |&gt; \n    tibble::as_tibble() |&gt;\n    janitor::get_dupes(-c(path)) |&gt;\n    dplyr::select(-hash)\n\nreports_dup |&gt; knitr::kable()\n\n\n\n\n\n\n\n\n\nid\next\ndupe_count\npath\n\n\n\n\nBMK-PFC-23-10\npdf\n3\nC:/Users/VissaultS/Documents/03-Labo/Results Reports/BMK-PFC-23-10_HERG-COEI_eggs2023.pdf\n\n\nBMK-PFC-23-10\npdf\n3\nC:/Users/VissaultS/Documents/03-Labo/Results Reports/EideràDuvet Rapports 1972-2023/BMK-PFC-23-10_HERG-COEI_eggs2023.pdf\n\n\nBMK-PFC-23-10\npdf\n3\nC:/Users/VissaultS/Documents/03-Labo/Results Reports/GoelandArgente 2017, 2022-23/BMK-PFC-23-10_HERG-COEI_eggs2023.pdf\n\n\nCHEM-OC-22-10\npdf\n3\nC:/Users/VissaultS/Documents/03-Labo/Results Reports/CHEM-OC-22-10_GBHE-HERG2022.pdf\n\n\nCHEM-OC-22-10\npdf\n3\nC:/Users/VissaultS/Documents/03-Labo/Results Reports/GoelandArgente 2017, 2022-23/CHEM-OC-22-10_GBHE-HERG2022.pdf\n\n\nCHEM-OC-22-10\npdf\n3\nC:/Users/VissaultS/Documents/03-Labo/Results Reports/GrandHeron Rapports xxxx-2022/Rapports/CHEM-OC-22-10_GBHE-HERG2022.pdf\n\n\nMET-THg-22-05\npdf\n3\nC:/Users/VissaultS/Documents/03-Labo/Results Reports/GoelandArgente 2017, 2022-23/MET-THg-22-05 - RALA01-2022_HERG-GBHEegg2022.pdf\n\n\nMET-THg-22-05\npdf\n3\nC:/Users/VissaultS/Documents/03-Labo/Results Reports/GrandHeron Rapports xxxx-2022/Rapports/MET-THg-22-05 - RALA01-2022_HERG-GBHEegg2022.pdf\n\n\nMET-THg-22-05\npdf\n3\nC:/Users/VissaultS/Documents/03-Labo/Results Reports/MET-THg-22-05 - RALA01-2022_HERG-GBHEegg2022.pdf\n\n\nMET-THg-23-13\npdf\n3\nC:/Users/VissaultS/Documents/03-Labo/Results Reports/EideràDuvet Rapports 1972-2023/MET-THg-23-13 - RALA01-2023.pdf\n\n\nMET-THg-23-13\npdf\n3\nC:/Users/VissaultS/Documents/03-Labo/Results Reports/GoelandArgente 2017, 2022-23/MET-THg-23-13 - RALA01-2023.pdf\n\n\nMET-THg-23-13\npdf\n3\nC:/Users/VissaultS/Documents/03-Labo/Results Reports/MET-THg-23-13 - RALA01-2023_OeufsCOEI-HERG2023.pdf\n\n\nTP-SI-22-09\npdf\n3\nC:/Users/VissaultS/Documents/03-Labo/Results Reports/GoelandArgente 2017, 2022-23/TP-SI-22-09C_RALA01-2022_HERG-GBHEeggs2022.pdf\n\n\nTP-SI-22-09\npdf\n3\nC:/Users/VissaultS/Documents/03-Labo/Results Reports/GrandHeron Rapports xxxx-2022/Rapports/TP-SI-22-09C_RALA01-2022_HERG-GBHEeggs2022.pdf\n\n\nTP-SI-22-09\npdf\n3\nC:/Users/VissaultS/Documents/03-Labo/Results Reports/TP-SI-22-09C_RALA01-2022_HERG-GBHEeggs2022.pdf\n\n\nCHEM-OC-21-08\npdf\n2\nC:/Users/VissaultS/Documents/03-Labo/Results Reports/CHEM-OC-21-08R.pdf\n\n\nCHEM-OC-21-08\npdf\n2\nC:/Users/VissaultS/Documents/03-Labo/Results Reports/FouBassan Rapports 1984-2019/CHEM-OC-21-08R.pdf\n\n\nCHEM-OC-22-05\npdf\n2\nC:/Users/VissaultS/Documents/03-Labo/Results Reports/CHEM-OC-22-05_HERGDeslauriers.pdf\n\n\nCHEM-OC-22-05\npdf\n2\nC:/Users/VissaultS/Documents/03-Labo/Results Reports/GoelandArgente 2017, 2022-23/CHEM-OC-22-05_HERGDeslauriers.pdf\n\n\nCHEM-OC-23-08\npdf\n2\nC:/Users/VissaultS/Documents/03-Labo/Results Reports/CHEM-OC-23-08_EggHERG_COEI_2023.pdf\n\n\nCHEM-OC-23-08\npdf\n2\nC:/Users/VissaultS/Documents/03-Labo/Results Reports/EideràDuvet Rapports 1972-2023/CHEM-OC-23-08_EggHERG_COEI_2023.pdf\n\n\nMET-THg-21-03\npdf\n2\nC:/Users/VissaultS/Documents/03-Labo/Results Reports/FouBassan Rapports 1984-2019/MET-THg-21-03.pdf\n\n\nMET-THg-21-03\npdf\n2\nC:/Users/VissaultS/Documents/03-Labo/Results Reports/MET-THg-21-03 - RALA01-2021_eggs.pdf\n\n\nTP-SI-21-05\npdf\n2\nC:/Users/VissaultS/Documents/03-Labo/Results Reports/FouBassan Rapports 1984-2019/TP-SI-21-05C.pdf\n\n\nTP-SI-21-05\npdf\n2\nC:/Users/VissaultS/Documents/03-Labo/Results Reports/TP-SI-21-05C_RALA01-2021.pdf\n\n\n\nOn selectionne le premier rapport en se basant sur le id (ex. BMK-PFC-23-01) pour éliminer les rapports dupliqués pour la suite de l’analyse. On s’assure de selectionner préférablement les pdfs si on dispose d’un docx et d’un document pdf pour le même identifiant de rapport de laboratoire.\n\nreports &lt;- reports |&gt; \n    # On retire les rapports qui sont dupliqués\n    dplyr::group_by(hash) |&gt;\n    dplyr::slice(1) |&gt;\n    dplyr::ungroup() |&gt;\n    # Si plusieurs extension de fichiers, on selectionne ceux en PDF préférablement, sinon .docx, sinon .doc en dernier recours.\n    dplyr::group_split(id) |&gt;\n    purrr::map(\\(g){\n        g |&gt; dplyr::arrange(factor(ext, levels = c('pdf', 'docx', 'doc'))) |&gt;\n        dplyr::slice(1)\n    }) |&gt;\n    dplyr::bind_rows()\n\nQuelques rapports de laboratoire demeurent au format doc et docx.\ndocs &lt;- reports |&gt; dplyr::filter(ext %in% c('doc', 'docx')) \ndocs |&gt; knitr::kable()\n\n\n\npath\nid\nhash\next\n\n\n\n\n\nAfin de faciliter l’extraction des métadonnées par programmation, on convertit les fichiers .doc et .docx en pdf.",
    "crumbs": [
      "Consolider les données",
      "Recensement des projets"
    ]
  },
  {
    "objectID": "tbl_projects.html#établir-une-liste-des-projets",
    "href": "tbl_projects.html#établir-une-liste-des-projets",
    "title": "Recensement des projets",
    "section": "",
    "text": "Chaque rapport de laboratoire contient sur sa page de garde l’ensemble des métadonnées en lien avec le projet de recherche pour lequel cette analyse a été demandé. On désire donc extraire la page de garde de chacun des rapports de laboratoires afin d’obtenir la liste des projets.\nUn rapport de laboratoire peut être detectable dans une liste de fichier par la structure de son identifiant unique. Voici un exemple d’identifiant unique: CHEM-PCDD-00-07 ou encore MB-05-10. Ces identifiants ont une structure unique que l’on peut detecter grace à l’expression régulière suivante:\n\nregex_report_id &lt;- \"([A-Za-z]{2,5}-)?[A-Za-z]{2,5}-\\\\d{2}-\\\\d{2}\"\n\nLa variable regex_report_id sera utilisée plusieurs fois dans ce document.\nOn liste les rapports de laboratoire présents dans le dossier 03-Labo/Results Reports.\n\nreports_path &lt;- list.files(\n    \"C:/Users/VissaultS/Documents/03-Labo/Results Reports\", \n    pattern = \"*.pdf|*.docx|*.doc\", recursive = TRUE, full.names = TRUE\n)\n\n# On extrait les identifiants des rapports du nom du fichier\nreport_id &lt;- stringr::str_extract(reports_path, regex_report_id)\n\n# On obtient la signature du fichier, ca va être pratique pour detecter les fichiers dupliqués même si le nom du fichier est différent.\nfile_hash &lt;- tools::md5sum(reports_path)\n\n# On extrait l'extension du fichier\nfile_ext &lt;- reports_path |&gt; \n    strsplit(\"[.]\") |&gt; \n    purrr::map_chr(\\(e) return(e[2]))\n\n# On compose un tableau avec l'ensemble de ces informations\nreports &lt;- data.frame(\n        path = reports_path, \n        id = report_id, \n        hash = file_hash, \n        ext = file_ext\n    ) |&gt; tibble::as_tibble()\n\nNote: tools::md5sum permet de générer une signature unique propre au fichier. Ainsi deux fichiers identiques dans le contenu mais avec des noms différents pourront être identifié comme des duplicats.\nVoici la liste des fichiers identiques dans le dossier 03-Labo/Results Reports.\nreports_dup &lt;- reports |&gt; \n    tibble::as_tibble() |&gt;\n    janitor::get_dupes(-c(path)) |&gt;\n    dplyr::select(-hash)\n\nreports_dup |&gt; knitr::kable()\n\n\n\n\n\n\n\n\n\nid\next\ndupe_count\npath\n\n\n\n\nBMK-PFC-23-10\npdf\n3\nC:/Users/VissaultS/Documents/03-Labo/Results Reports/BMK-PFC-23-10_HERG-COEI_eggs2023.pdf\n\n\nBMK-PFC-23-10\npdf\n3\nC:/Users/VissaultS/Documents/03-Labo/Results Reports/EideràDuvet Rapports 1972-2023/BMK-PFC-23-10_HERG-COEI_eggs2023.pdf\n\n\nBMK-PFC-23-10\npdf\n3\nC:/Users/VissaultS/Documents/03-Labo/Results Reports/GoelandArgente 2017, 2022-23/BMK-PFC-23-10_HERG-COEI_eggs2023.pdf\n\n\nCHEM-OC-22-10\npdf\n3\nC:/Users/VissaultS/Documents/03-Labo/Results Reports/CHEM-OC-22-10_GBHE-HERG2022.pdf\n\n\nCHEM-OC-22-10\npdf\n3\nC:/Users/VissaultS/Documents/03-Labo/Results Reports/GoelandArgente 2017, 2022-23/CHEM-OC-22-10_GBHE-HERG2022.pdf\n\n\nCHEM-OC-22-10\npdf\n3\nC:/Users/VissaultS/Documents/03-Labo/Results Reports/GrandHeron Rapports xxxx-2022/Rapports/CHEM-OC-22-10_GBHE-HERG2022.pdf\n\n\nMET-THg-22-05\npdf\n3\nC:/Users/VissaultS/Documents/03-Labo/Results Reports/GoelandArgente 2017, 2022-23/MET-THg-22-05 - RALA01-2022_HERG-GBHEegg2022.pdf\n\n\nMET-THg-22-05\npdf\n3\nC:/Users/VissaultS/Documents/03-Labo/Results Reports/GrandHeron Rapports xxxx-2022/Rapports/MET-THg-22-05 - RALA01-2022_HERG-GBHEegg2022.pdf\n\n\nMET-THg-22-05\npdf\n3\nC:/Users/VissaultS/Documents/03-Labo/Results Reports/MET-THg-22-05 - RALA01-2022_HERG-GBHEegg2022.pdf\n\n\nMET-THg-23-13\npdf\n3\nC:/Users/VissaultS/Documents/03-Labo/Results Reports/EideràDuvet Rapports 1972-2023/MET-THg-23-13 - RALA01-2023.pdf\n\n\nMET-THg-23-13\npdf\n3\nC:/Users/VissaultS/Documents/03-Labo/Results Reports/GoelandArgente 2017, 2022-23/MET-THg-23-13 - RALA01-2023.pdf\n\n\nMET-THg-23-13\npdf\n3\nC:/Users/VissaultS/Documents/03-Labo/Results Reports/MET-THg-23-13 - RALA01-2023_OeufsCOEI-HERG2023.pdf\n\n\nTP-SI-22-09\npdf\n3\nC:/Users/VissaultS/Documents/03-Labo/Results Reports/GoelandArgente 2017, 2022-23/TP-SI-22-09C_RALA01-2022_HERG-GBHEeggs2022.pdf\n\n\nTP-SI-22-09\npdf\n3\nC:/Users/VissaultS/Documents/03-Labo/Results Reports/GrandHeron Rapports xxxx-2022/Rapports/TP-SI-22-09C_RALA01-2022_HERG-GBHEeggs2022.pdf\n\n\nTP-SI-22-09\npdf\n3\nC:/Users/VissaultS/Documents/03-Labo/Results Reports/TP-SI-22-09C_RALA01-2022_HERG-GBHEeggs2022.pdf\n\n\nCHEM-OC-21-08\npdf\n2\nC:/Users/VissaultS/Documents/03-Labo/Results Reports/CHEM-OC-21-08R.pdf\n\n\nCHEM-OC-21-08\npdf\n2\nC:/Users/VissaultS/Documents/03-Labo/Results Reports/FouBassan Rapports 1984-2019/CHEM-OC-21-08R.pdf\n\n\nCHEM-OC-22-05\npdf\n2\nC:/Users/VissaultS/Documents/03-Labo/Results Reports/CHEM-OC-22-05_HERGDeslauriers.pdf\n\n\nCHEM-OC-22-05\npdf\n2\nC:/Users/VissaultS/Documents/03-Labo/Results Reports/GoelandArgente 2017, 2022-23/CHEM-OC-22-05_HERGDeslauriers.pdf\n\n\nCHEM-OC-23-08\npdf\n2\nC:/Users/VissaultS/Documents/03-Labo/Results Reports/CHEM-OC-23-08_EggHERG_COEI_2023.pdf\n\n\nCHEM-OC-23-08\npdf\n2\nC:/Users/VissaultS/Documents/03-Labo/Results Reports/EideràDuvet Rapports 1972-2023/CHEM-OC-23-08_EggHERG_COEI_2023.pdf\n\n\nMET-THg-21-03\npdf\n2\nC:/Users/VissaultS/Documents/03-Labo/Results Reports/FouBassan Rapports 1984-2019/MET-THg-21-03.pdf\n\n\nMET-THg-21-03\npdf\n2\nC:/Users/VissaultS/Documents/03-Labo/Results Reports/MET-THg-21-03 - RALA01-2021_eggs.pdf\n\n\nTP-SI-21-05\npdf\n2\nC:/Users/VissaultS/Documents/03-Labo/Results Reports/FouBassan Rapports 1984-2019/TP-SI-21-05C.pdf\n\n\nTP-SI-21-05\npdf\n2\nC:/Users/VissaultS/Documents/03-Labo/Results Reports/TP-SI-21-05C_RALA01-2021.pdf\n\n\n\nOn selectionne le premier rapport en se basant sur le id (ex. BMK-PFC-23-01) pour éliminer les rapports dupliqués pour la suite de l’analyse. On s’assure de selectionner préférablement les pdfs si on dispose d’un docx et d’un document pdf pour le même identifiant de rapport de laboratoire.\n\nreports &lt;- reports |&gt; \n    # On retire les rapports qui sont dupliqués\n    dplyr::group_by(hash) |&gt;\n    dplyr::slice(1) |&gt;\n    dplyr::ungroup() |&gt;\n    # Si plusieurs extension de fichiers, on selectionne ceux en PDF préférablement, sinon .docx, sinon .doc en dernier recours.\n    dplyr::group_split(id) |&gt;\n    purrr::map(\\(g){\n        g |&gt; dplyr::arrange(factor(ext, levels = c('pdf', 'docx', 'doc'))) |&gt;\n        dplyr::slice(1)\n    }) |&gt;\n    dplyr::bind_rows()\n\nQuelques rapports de laboratoire demeurent au format doc et docx.\ndocs &lt;- reports |&gt; dplyr::filter(ext %in% c('doc', 'docx')) \ndocs |&gt; knitr::kable()\n\n\n\npath\nid\nhash\next\n\n\n\n\n\nAfin de faciliter l’extraction des métadonnées par programmation, on convertit les fichiers .doc et .docx en pdf.",
    "crumbs": [
      "Consolider les données",
      "Recensement des projets"
    ]
  },
  {
    "objectID": "tbl_projects.html#convertion-des-documents-word-en-pdf",
    "href": "tbl_projects.html#convertion-des-documents-word-en-pdf",
    "title": "Recensement des projets",
    "section": "Convertion des documents Word en pdf",
    "text": "Convertion des documents Word en pdf\nCette étape a été complété manuellement.",
    "crumbs": [
      "Consolider les données",
      "Recensement des projets"
    ]
  },
  {
    "objectID": "tbl_projects.html#extraire-les-métadonnées-du-rapport",
    "href": "tbl_projects.html#extraire-les-métadonnées-du-rapport",
    "title": "Recensement des projets",
    "section": "Extraire les métadonnées du rapport",
    "text": "Extraire les métadonnées du rapport\nNous souhaitons générer une liste de tous les projets basée sur les 71 rapports de laboratoire stockés dans le dossier 03-Labo/Comptes rendus de résultats. La première page de chaque rapport de laboratoire contient toutes les informations pertinentes pour produire cette liste.\nPour chaque rapport, nous vérifions s’il s’agit d’une image ou non. Si le rapport est une image, nous devons utiliser une reconnaissance optique de caractères (OCR) afin d’extraire le texte de la première page et d’obtenir toutes les métadonnées pertinentes. Si c’est un pdf ou un fichier word, nous importons la première page du document.\n\n# On détect si le document est une image\nreports &lt;- reports |&gt; dplyr::mutate(\n    filename = basename(path),\n    is_image = purrr::map2_lgl(path, ext, \\(p, e) {\n        if(e == \"pdf\"){\n            out &lt;- pdftools::pdf_text(p)\n            !all(nchar(out) &gt; 15)\n        } else {\n            FALSE\n        }\n    })\n)\n\n# On extrait le texte par OCR si c'est une image\nfrontpages &lt;- purrr::map2_vec(reports$path, reports$is_image, \\(p, i) {\n        ifelse(isTRUE(i), \n            pdftools::pdf_ocr_text(pdf = p, pages = 1),\n            pdftools::pdf_text(pdf = p)[[1]]\n        )\n    }) |&gt; tolower()\n\nUne fois le texte de la première page isolé, on applique une série d’opération d’extractions de texte à partir de la position de mots clés. On isole ainsi le titre du projet, l’ID du projet, la date etc.\n\nproject_id &lt;- purrr::map_vec(frontpages, \\(f){\n    stringr::str_extract(f, \"(?&lt;=(project: |project |projects|projet :)).*(?=\\n)\")\n}) |&gt; \n    toupper() |&gt; \n    stringr::word(1) |&gt; \n    stringr::str_replace_all(\"[.,]\", \"\") |&gt;\n    stringr::str_trim() |&gt;\n    dplyr::na_if(\"\")\n\nproject_leader &lt;- purrr::map_vec(frontpages, \\(f){\n        stringr::str_extract(f, \"(?&lt;=(project leader: |project leader |project manager: |manager: |study leader: |nom du requérant :)).*(?=\\n)\")\n    }) |&gt; \n    stringr::str_replace_all(c(\"[_|:]\" = \"\", \"[:digit:]\" = \"\", \"[.]$\" = \"\")) |&gt; \n    stringr::str_to_title() |&gt;\n    stringr::str_trim()\n\nproject_dates &lt;- frontpages |&gt;\n    purrr::map_vec(\\(f){\n        dates &lt;- stringr::str_extract(f, \"\\\\d{4}-\\\\d{2}-\\\\d{2}\")\n        if(is.na(dates)) {\n            dates &lt;- stringr::str_extract(f, \"(?&lt;=(date: )).*(?=\\n)\")\n        }\n        return(dates)\n    }) \n        \nreportsProject &lt;- data.frame(\n    report_id = reports$id, \n    report_access_path = stringr::str_replace_all(reports$path, \"C:/Users/VissaultS/Documents\", \"Z:\"), \n    project_id, project_leader, project_dates, project_title = NA\n)\n\nLe data.frame reportsProject est à la base du fichier “Z:\\07-Données BD_projects_list_extract_25032024.xlsx”.",
    "crumbs": [
      "Consolider les données",
      "Recensement des projets"
    ]
  },
  {
    "objectID": "tbl_projects.html#valider-lexistence-de-rapports-de-laboratoire-dans-le-dossier-01-projet-et-suivis",
    "href": "tbl_projects.html#valider-lexistence-de-rapports-de-laboratoire-dans-le-dossier-01-projet-et-suivis",
    "title": "Recensement des projets",
    "section": "Valider l’existence de rapports de laboratoire dans le dossier 01-Projet et suivis",
    "text": "Valider l’existence de rapports de laboratoire dans le dossier 01-Projet et suivis\nOn valide si certains de ces rapports ne se retrouvent pas dans le dossier 03-Labo/Comptes rendus. Ces rapports pourraient potentiellement nous interressés.\n\nfiles &lt;- list.files(\n    \"C:/Users/VissaultS/Documents/01-Projets et suivis\", \n    pattern = \"*.pdf|*.docx|*.doc\", recursive = TRUE, full.names = TRUE\n)\n\npotential_reports &lt;- data.frame(file = files[which(stringr::str_detect(files, regex_report_id))])\n\npotential_reports &lt;- potential_reports |&gt; dplyr::mutate(\n    id = stringr::str_extract(file, regex_report_id) |&gt; toupper(),\n    in_lab_report_folder = !(id %in% reports$id)\n) |&gt; dplyr::arrange(in_lab_report_folder) |&gt;\n    dplyr::mutate(file = stringr::str_replace(file, \"C:/Users/VissaultS/Documents/\", \"Z:\"))",
    "crumbs": [
      "Consolider les données",
      "Recensement des projets"
    ]
  }
]